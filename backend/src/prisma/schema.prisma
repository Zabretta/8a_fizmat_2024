generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        String    @id @default(uuid())
  nickname  String    @unique
  code      String
  avatar    String    @unique @default("üë§")
  online    Boolean   @default(false)
  createdAt DateTime  @default(now())
  messages  Message[]
  
  // –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨: –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  role      String    @default("user")
  
  // –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨: –°–í–Ø–ó–ò (–≠–¢–û –í–ê–ñ–ù–û!)
  adminLogs AdminLog[] // –î–µ–π—Å—Ç–≤–∏—è, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∫–∞–∫ –∞–¥–º–∏–Ω–æ–º
  bans      UserBan[]  // üëà‚ö†Ô∏è –ö–õ–Æ–ß–ï–í–ê–Ø –°–¢–†–û–ö–ê! –≠–¢–û–ô –ù–ï –•–í–ê–¢–ê–õ–û
}

model Message {
  id        String   @id @default(uuid())
  content   String
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
}

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞
model AdminLog {
  id        String   @id @default(uuid())
  action    String
  targetId  String?
  details   String?
  createdAt DateTime @default(now())
  
  adminId   String
  admin     User     @relation(fields: [adminId], references: [id])
  
  @@index([adminId])
  @@index([createdAt])
}

// –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ç–∞–±–∞
model SystemSettings {
  id        String   @id @default("squad-config")
  
  squadCode         String  @default("8A-FIZMAT")
  allowCustomAvatars Boolean @default(true)
  systemMessage     String?
  systemMessageActive Boolean @default(false)
  profanityFilter   Boolean @default(false)
  requireModeration Boolean @default(false)
  
  updatedAt DateTime @updatedAt
  updatedBy String?
  
  @@map("system_settings")
}

// –ó–∞–±–∞–Ω–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
model BannedWord {
  id        String   @id @default(uuid())
  word      String   @unique
  addedBy   String
  createdAt DateTime @default(now())
  
  @@map("banned_words")
}

// –í—Ä–µ–º–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
model UserBan {
  id        String   @id @default(uuid())
  userId    String   @unique
  user      User     @relation(fields: [userId], references: [id]) // –°–≤—è–∑—å —Å User
  reason    String?
  bannedBy  String
  bannedAt  DateTime @default(now())
  expiresAt DateTime?
  
  @@map("user_bans")
}